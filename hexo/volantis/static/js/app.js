
document.addEventListener("DOMContentLoaded",function(){volantis.requestAnimationFrame(()=>{VolantisApp.init();VolantisApp.subscribe();VolantisFancyBox.init();highlightKeyWords.startFromURL();locationHash();volantis.pjax.push(()=>{VolantisApp.pjaxReload();VolantisFancyBox.init();sessionStorage.setItem("domTitle",document.title);highlightKeyWords.startFromURL();},'app.js');volantis.pjax.send(()=>{volantis.dom.switcher.removeClass('active');volantis.dom.header.removeClass('z_search-open');volantis.dom.wrapper.removeClass('sub');volantis.EventListener.remove()},'app.js');});});const locationHash=()=>{if(window.location.hash){let locationID=decodeURI(window.location.hash.split('#')[1]).replace(/\ /g,'-');let target=document.getElementById(locationID);if(target){setTimeout(()=>{if(window.location.hash.startsWith('#fn')){volantis.scroll.to(target,{addTop:-volantis.dom.header.offsetHeight-5,behavior:'instant',observer:true})}else{volantis.scroll.to(target,{addTop:5,behavior:'instant',observer:true})}},1000)}}}
Object.freeze(locationHash);const VolantisApp=(()=>{const fn={},COPYHTML='<button class="btn-copy" data-clipboard-snippet=""><i class="fa-solid fa-copy"></i><span>COPY</span></button>';let scrollCorrection=80;fn.init=()=>{if(volantis.dom.header){scrollCorrection=volantis.dom.header.clientHeight+16;}
window.onresize=()=>{if(document.documentElement.clientWidth<500){volantis.isMobile=1;}else{volantis.isMobile=0;}
if(volantis.isMobile!=volantis.isMobileOld){fn.setGlobalHeaderMenuEvent();fn.setHeader();fn.setHeaderSearch();}}
volantis.scroll.push(fn.scrollEventCallBack,"scrollEventCallBack")}
fn.event=()=>{volantis.dom.$(document.getElementById("scroll-down"))?.on('click',function(){fn.scrolltoElement(volantis.dom.bodyAnchor);});const sidebar=document.querySelector("#l_side")if(sidebar){const sectionList=sidebar.querySelectorAll("section")if(!sectionList.length){document.querySelector("#l_main").classList.add("no_sidebar")}}
if(volantis.GLOBAL_CONFIG.sidebar.for_page.includes('webinfo')||volantis.GLOBAL_CONFIG.sidebar.for_post.includes('webinfo')){const lastupd=volantis.GLOBAL_CONFIG.sidebar.webinfo.lastupd;if(!!document.getElementById('last-update-show')&&lastupd.enable&&lastupd.friendlyShow){document.getElementById('last-update-show').innerHTML=fn.utilTimeAgo(volantis.GLOBAL_CONFIG.lastupdate);}}
if(!!document.getElementById('webinfo-runtime-count')){let BirthDay=new Date(volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.data);let timeold=(new Date().getTime()-BirthDay.getTime());let daysold=Math.floor(timeold/(24*60*60*1000));document.getElementById('webinfo-runtime-count').innerHTML=`${daysold}
${volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.unit}`;}
document.body.oncopy=function(){fn.messageCopyright()};}
fn.restData=()=>{scrollCorrection=volantis.dom.header?volantis.dom.header.clientHeight+16:80;}
fn.setIsMobile=()=>{if(document.documentElement.clientWidth<500){volantis.isMobile=1;volantis.isMobileOld=1;}else{volantis.isMobile=0;volantis.isMobileOld=0;}}
fn.scrolltoElement=(elem,correction=scrollCorrection)=>{volantis.scroll.to(elem,{top:elem.offsetTop-correction})}
fn.scrollEventCallBack=()=>{const showHeaderPoint=volantis.dom.bodyAnchor.offsetTop-scrollCorrection;const scrollTop=volantis.scroll.getScrollTop();if(volantis.dom.topBtn){if(scrollTop>volantis.dom.bodyAnchor.offsetTop){volantis.dom.topBtn.addClass('show');if(volantis.scroll.del>0){volantis.dom.topBtn.removeClass('hl');}else{volantis.dom.topBtn.addClass('hl');}}else{volantis.dom.topBtn.removeClass('show').removeClass('hl');}}
if(volantis.dom.header){if(scrollTop-showHeaderPoint>-1){volantis.dom.header.addClass('show');}else{volantis.dom.header.removeClass('show');}}
if(pdata.ispage&&volantis.dom.wrapper){if(volantis.scroll.del>0&&scrollTop>100){volantis.dom.wrapper.addClass('sub');}else if(volantis.scroll.del<0){volantis.dom.wrapper.removeClass('sub');}}
if(volantis.isMobile){if(pdata.ispage&&volantis.dom.tocTarget&&volantis.dom.toc){volantis.dom.tocTarget.removeClass('active');volantis.dom.toc.removeClass('active');}
if(volantis.dom.mPhoneList){volantis.dom.mPhoneList.forEach(function(e){volantis.dom.$(e).hide();})}}}
fn.setScrollAnchor=()=>{if(volantis.dom.topBtn&&volantis.dom.bodyAnchor){volantis.dom.topBtn.click(e=>{e.preventDefault();e.stopPropagation();fn.scrolltoElement(volantis.dom.bodyAnchor);e.stopImmediatePropagation();});}}
fn.setHeader=()=>{if(!pdata.ispage)return;volantis.dom.wrapper.find('.nav-sub .title').html(document.title.split(" - ")[0]);volantis.dom.comment=volantis.dom.$(document.getElementById("s-comment"));volantis.dom.commentTarget=volantis.dom.$(document.querySelector('#l_main article#comments'));if(volantis.dom.commentTarget){volantis.dom.comment.click(e=>{e.preventDefault();e.stopPropagation();fn.scrolltoElement(volantis.dom.commentTarget);e.stopImmediatePropagation();});}else volantis.dom.comment.style.display='none';if(volantis.isMobile){volantis.dom.toc=volantis.dom.$(document.getElementById("s-toc"));volantis.dom.tocTarget=volantis.dom.$(document.querySelector('#l_side .toc-wrapper'));if(volantis.dom.tocTarget){volantis.dom.toc.click((e)=>{e.stopPropagation();volantis.dom.tocTarget.toggleClass('active');volantis.dom.toc.toggleClass('active');});volantis.dom.$(document).click(function(e){e.stopPropagation();if(volantis.dom.tocTarget){volantis.dom.tocTarget.removeClass('active');}
volantis.dom.toc.removeClass('active');});}else volantis.dom.toc.style.display='none';}}
fn.setHeaderMenuSelection=()=>{volantis.dom.headerMenu=volantis.dom.$(document.querySelectorAll('#l_header .navigation,#l_cover .navigation,#l_side .navigation'));volantis.dom.headerMenu.forEach(element=>{let li=volantis.dom.$(element).find('li a.active')if(li)li.removeClass('active')let div=volantis.dom.$(element).find('div a.active')if(div)div.removeClass('active')});var idname=location.pathname.replace(/\/|%|\./g,'');if(idname.length==0){idname='home';}
var page=idname.match(/page\d{0,}$/g);if(page){page=page[0];idname=idname.split(page)[0];}
var index=idname.match(/index.html/);if(index){index=index[0];idname=idname.split(index)[0];}
idname=idname.replace(/(\[|\]|~|#|@)/g,'\\$1');if(idname&&volantis.dom.headerMenu){volantis.dom.headerMenu.forEach(element=>{let id=element.querySelector("[active-action=action-"+idname+"]")if(id){volantis.dom.$(id).addClass('active')}});}}
fn.setGlobalHeaderMenuEvent=()=>{if(volantis.isMobile){document.querySelectorAll('#l_header .m-phone li').forEach(function(_e){if(_e.querySelector(".list-v")){volantis.dom.$(_e).click(function(e){e.stopPropagation();let menuType=''
Array.from(e.currentTarget.children).some(val=>{if(val.classList.contains('s-menu')){menuType='menu'
return}
if(val.classList.contains('menuitem')){menuType='item'
return}})if(menuType==='item'){e.currentTarget.parentElement.childNodes.forEach(function(e2){if(Object.prototype.toString.call(e2)=='[object HTMLLIElement]'){e2.childNodes.forEach(function(e1){if(Object.prototype.toString.call(e1)=='[object HTMLUListElement]'){volantis.dom.$(e1).hide()}})}})
let array=e.currentTarget.children
for(let index=0;index<array.length;index++){const element=array[index];if(volantis.dom.$(element).title==='menu'){volantis.dom.$(element).style.display="flex"}else{volantis.dom.$(element).show()}}}else{let menuPhone=document.querySelector('.switcher .menu-phone')let isHiding=window.getComputedStyle(menuPhone).display==='none'
if(isHiding){volantis.dom.$(menuPhone).show()}else{volantis.dom.$(menuPhone).hide()
document.querySelector('.switcher .menu-phone').childNodes.forEach(function(e2){if(Object.prototype.toString.call(e2)=='[object HTMLLIElement]'){e2.childNodes.forEach(function(e1){if(Object.prototype.toString.call(e1)=='[object HTMLUListElement]'){volantis.dom.$(e1).hide()}})}})}}},0);}})}else{document.querySelectorAll('#wrapper .m-pc li > a[href]').forEach(function(e){volantis.dom.$(e.parentElement).click(function(e){e.stopPropagation();if(e.target.origin==e.target.baseURI){document.querySelectorAll('#wrapper .m-pc .list-v').forEach(function(e){volantis.dom.$(e).hide();})}},0);})}
fn.setPageHeaderMenuEvent();}
fn.setPageHeaderMenuEvent=()=>{if(!volantis.isMobile)return
volantis.dom.$(document).click(function(e){volantis.dom.mPhoneList.forEach(function(e){volantis.dom.$(e).hide();})});}
fn.setHeaderSearch=()=>{if(!volantis.isMobile)return;if(!volantis.dom.switcher)return;volantis.dom.switcher.click(function(e){e.stopPropagation();volantis.dom.header.toggleClass('z_search-open');volantis.dom.switcher.toggleClass('active');},false);volantis.dom.$(document).click(function(e){volantis.dom.header.removeClass('z_search-open');volantis.dom.switcher.removeClass('active');},false);volantis.dom.search.click(function(e){e.stopPropagation();},false);}
fn.setTabs=()=>{let tabs=document.querySelectorAll('#l_main .tabs .nav-tabs')if(!tabs)return tabs.forEach(function(e){e.querySelectorAll('a').forEach(function(e){volantis.dom.$(e).on('click',(e)=>{e.preventDefault();e.stopPropagation();const $tab=volantis.dom.$(e.target.parentElement.parentElement.parentElement);$tab.find('.nav-tabs .active').removeClass('active');volantis.dom.$(e.target.parentElement).addClass('active');$tab.find('.tab-content .active').removeClass('active');$tab.find(e.target.className).addClass('active');return false;});})})}
fn.footnotes=()=>{let ref=document.querySelectorAll('#l_main .footnote-backref, #l_main .footnote-ref > a');ref.forEach(function(e,i){ref[i].click=()=>{};volantis.dom.$(e).on('click',(e)=>{e.stopPropagation();e.preventDefault();let targetID=decodeURI(e.target.hash.split('#')[1]).replace(/\ /g,'-');let target=document.getElementById(targetID);if(target){volantis.scroll.to(target,{addTop:-volantis.dom.header.offsetHeight-5,behavior:'instant'})}});})}
fn.utilCopyCode=(Selector)=>{document.querySelectorAll(Selector).forEach(node=>{const test=node.insertAdjacentHTML("beforebegin",COPYHTML);const _BtnCopy=node.previousSibling;_BtnCopy.onclick=e=>{e.stopPropagation();const _icon=_BtnCopy.querySelector('i');const _span=_BtnCopy.querySelector('span');node.focus();const range=new Range();range.selectNodeContents(node);document.getSelection().removeAllRanges();document.getSelection().addRange(range);const str=document.getSelection().toString();fn.utilWriteClipText(str).then(()=>{fn.messageCopyright();_BtnCopy.classList.add('copied');_icon.classList.remove('fa-copy');_icon.classList.add('fa-check-circle');_span.innerText="COPIED";setTimeout(()=>{_icon.classList.remove('fa-check-circle');_icon.classList.add('fa-copy');_span.innerText="COPY";},2000)}).catch(e=>{VolantisApp.message('系统提示',e,{icon:'fa fa-exclamation-circle red'});_BtnCopy.classList.add('copied-failed');_icon.classList.remove('fa-copy');_icon.classList.add('fa-exclamation-circle');_span.innerText="COPY FAILED";setTimeout(()=>{_icon.classList.remove('fa-exclamation-circle');_icon.classList.add('fa-copy');_span.innerText="COPY";})})}});}
fn.utilWriteClipText=(str)=>{return navigator.clipboard.writeText(str).then(()=>{return Promise.resolve()}).catch(e=>{const input=document.createElement('textarea');input.setAttribute('readonly','readonly');document.body.appendChild(input);input.innerHTML=str;input.select();try{let result=document.execCommand('copy')document.body.removeChild(input);if(!result||result==='unsuccessful'){return Promise.reject('复制文本失败!')}else{return Promise.resolve()}}catch(e){document.body.removeChild(input);return Promise.reject('当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!')}})}
fn.utilTimeAgo=(dateTimeStamp)=>{const minute=1e3*60,hour=minute*60,day=hour*24,week=day*7,month=day*30;const now=new Date().getTime();const diffValue=now-dateTimeStamp;const minC=diffValue/minute,hourC=diffValue/hour,dayC=diffValue/day,weekC=diffValue/week,monthC=diffValue/month;if(diffValue<0){result=""}else if(monthC>=1&&monthC<7){result=" "+parseInt(monthC)+" 月前"}else if(weekC>=1&&weekC<4){result=" "+parseInt(weekC)+" 周前"}else if(dayC>=1&&dayC<7){result=" "+parseInt(dayC)+" 天前"}else if(hourC>=1&&hourC<24){result=" "+parseInt(hourC)+" 小时前"}else if(minC>=1&&minC<60){result=" "+parseInt(minC)+" 分钟前"}else if(diffValue>=0&&diffValue<=minute){result="刚刚"}else{const datetime=new Date();datetime.setTime(dateTimeStamp);const Nyear=datetime.getFullYear();const Nmonth=datetime.getMonth()+1<10?"0"+(datetime.getMonth()+1):datetime.getMonth()+1;const Ndate=datetime.getDate()<10?"0"+datetime.getDate():datetime.getDate();const Nhour=datetime.getHours()<10?"0"+datetime.getHours():datetime.getHours();const Nminute=datetime.getMinutes()<10?"0"+datetime.getMinutes():datetime.getMinutes();const Nsecond=datetime.getSeconds()<10?"0"+datetime.getSeconds():datetime.getSeconds();result=Nyear+"-"+Nmonth+"-"+Ndate}
return result;}
fn.message=(title,message,option={},done=null)=>{if(typeof iziToast==="undefined"){volantis.css(volantis.GLOBAL_CONFIG.plugins.message.css)volantis.js(volantis.GLOBAL_CONFIG.plugins.message.js,()=>{tozashMessage(title,message,option,done);});}else{tozashMessage(title,message,option,done);}
function tozashMessage(title,message,option,done){const{icon,time,position,transitionIn,transitionOut,messageColor,titleColor,backgroundColor,zindex,displayMode}=option;iziToast.show({layout:'2',icon:'Fontawesome',closeOnEscape:'true',displayMode:displayMode||'replace',transitionIn:transitionIn||volantis.GLOBAL_CONFIG.plugins.message.transitionIn,transitionOut:transitionOut||volantis.GLOBAL_CONFIG.plugins.message.transitionOut,messageColor:messageColor||volantis.GLOBAL_CONFIG.plugins.message.messageColor,titleColor:titleColor||volantis.GLOBAL_CONFIG.plugins.message.titleColor,backgroundColor:backgroundColor||volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,zindex:zindex||volantis.GLOBAL_CONFIG.plugins.message.zindex,icon:icon||volantis.GLOBAL_CONFIG.plugins.message.icon.default,timeout:time||volantis.GLOBAL_CONFIG.plugins.message.time.default,position:position||volantis.GLOBAL_CONFIG.plugins.message.position,title:title,message:message,onClosed:()=>{if(done)done();},});}}
fn.question=(title,message,option={},success=null,cancel=null,done=null)=>{if(typeof iziToast==="undefined"){volantis.css(volantis.GLOBAL_CONFIG.plugins.message.css)volantis.js(volantis.GLOBAL_CONFIG.plugins.message.js,()=>{tozashQuestion(title,message,option,success,cancel,done);});}else{tozashQuestion(title,message,option,success,cancel,done);}
function tozashQuestion(title,message,option,success,cancel,done){const{icon,time,position,transitionIn,transitionOut,messageColor,titleColor,backgroundColor,zindex}=option;iziToast.question({id:'question',icon:'Fontawesome',close:false,overlay:true,displayMode:'once',position:'center',messageColor:messageColor||volantis.GLOBAL_CONFIG.plugins.message.messageColor,titleColor:titleColor||volantis.GLOBAL_CONFIG.plugins.message.titleColor,backgroundColor:backgroundColor||volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,zindex:zindex||volantis.GLOBAL_CONFIG.plugins.message.zindex,icon:icon||volantis.GLOBAL_CONFIG.plugins.message.icon.quection,timeout:time||volantis.GLOBAL_CONFIG.plugins.message.time.quection,title:title,message:message,buttons:[['<button><b>是</b></button>',(instance,toast)=>{instance.hide({transitionOut:transitionOut||'fadeOut'},toast,'button');if(success)success(instance,toast)}],['<button><b>否</b></button>',(instance,toast)=>{instance.hide({transitionOut:transitionOut||'fadeOut'},toast,'button');if(cancel)cancel(instance,toast)}]],onClosed:(instance,toast,closedBy)=>{if(done)done(instance,toast,closedBy);}});}}
fn.hideMessage=(done=null)=>{const toast=document.querySelector('.iziToast');if(!toast){if(done)done()return;}
if(typeof iziToast==="undefined"){volantis.css(volantis.GLOBAL_CONFIG.plugins.message.css)volantis.js(volantis.GLOBAL_CONFIG.plugins.message.js,()=>{hideMessage(done);});}else{hideMessage(done);}
function hideMessage(done){iziToast.hide({},toast);if(done)done();}}
let messageCopyrightShow=0;fn.messageCopyright=()=>{if(volantis.GLOBAL_CONFIG.plugins.message.enable&&volantis.GLOBAL_CONFIG.plugins.message.copyright.enable&&messageCopyrightShow<1){messageCopyrightShow++;VolantisApp.message(volantis.GLOBAL_CONFIG.plugins.message.copyright.title,volantis.GLOBAL_CONFIG.plugins.message.copyright.message,{icon:volantis.GLOBAL_CONFIG.plugins.message.copyright.icon,transitionIn:'flipInX',transitionOut:'flipOutX',displayMode:1});}}
return{init:()=>{fn.init();fn.event();},subscribe:()=>{fn.setIsMobile();fn.setHeader();fn.setHeaderMenuSelection();fn.setGlobalHeaderMenuEvent();fn.setHeaderSearch();fn.setScrollAnchor();fn.setTabs();fn.footnotes();},pjaxReload:()=>{fn.event();fn.restData();fn.setHeader();fn.setHeaderMenuSelection();fn.setPageHeaderMenuEvent();fn.setScrollAnchor();fn.setTabs();fn.footnotes();document.querySelector("#l_header .nav-main").querySelectorAll('.list-v:not(.menu-phone)').forEach(function(e){e.removeAttribute("style")})document.querySelector("#l_header .menu-phone.list-v").removeAttribute("style");messageCopyrightShow=0;},utilCopyCode:fn.utilCopyCode,utilWriteClipText:fn.utilWriteClipText,utilTimeAgo:fn.utilTimeAgo,message:fn.message,question:fn.question,hideMessage:fn.hideMessage,messageCopyright:fn.messageCopyright,scrolltoElement:fn.scrolltoElement}})()Object.freeze(VolantisApp);const VolantisFancyBox=(()=>{const fn={};fn.loadFancyBox=(done)=>{volantis.css(volantis.GLOBAL_CONFIG.plugins.fancybox.css);volantis.js(volantis.GLOBAL_CONFIG.plugins.fancybox.js).then(()=>{if(done)done();})}
fn.init=(checkMain=true,done=fn.groupBind)=>{if(!document.querySelector(".md .gallery img, .fancybox")&&checkMain)return;if(typeof Fancybox==="undefined"){fn.loadFancyBox(done);}else{done();}}
fn.elementHandling=(selectors,name)=>{const nodeList=document.querySelectorAll(selectors);nodeList.forEach($item=>{if($item.hasAttribute('fancybox'))return;$item.setAttribute('fancybox','');const $link=document.createElement('a');$link.setAttribute('href',$item.src);$link.setAttribute('data-caption',$item.alt);$link.setAttribute('data-fancybox',name);$link.classList.add('fancybox');$link.append($item.cloneNode());$item.replaceWith($link);})}
fn.bind=(selectors)=>{fn.init(false,()=>{Fancybox.bind(selectors,{groupAll:true,Hash:false,hideScrollbar:false,Thumbs:{autoStart:false,},caption:function(fancybox,carousel,slide){return slide.$trigger.alt||null}});});}
fn.groupBind=(groupName=null)=>{const group=new Set();document.querySelectorAll(".gallery").forEach(ele=>{if(ele.querySelector("img")){group.add(ele.getAttribute('data-group')||'default');}})
if(!!groupName)group.add(groupName);for(const iterator of group){Fancybox.unbind('[data-fancybox="'+iterator+'"]');Fancybox.bind('[data-fancybox="'+iterator+'"]',{Hash:false,hideScrollbar:false,Thumbs:{autoStart:false,}});}}
return{init:fn.init,bind:fn.bind,groupBind:(selectors,groupName='default')=>{try{fn.elementHandling(selectors,groupName);fn.init(false,()=>{fn.groupBind(groupName)});}catch(error){console.error(error)}}}})()Object.freeze(VolantisFancyBox);const highlightKeyWords=(()=>{let fn={}
fn.markNum=0 fn.markNextId=-1 fn.startFromURL=()=>{const params=decodeURI(new URL(location.href).searchParams.get('keyword'));const keywords=params?params.split(' '):[];const post=document.querySelector('#l_main');if(keywords.length==1&&keywords[0]=="null"){return;}
fn.start(keywords,post);fn.scrollToFirstHighlightKeywordMark()}
fn.scrollToFirstHighlightKeywordMark=()=>{volantis.cleanContentVisibility();let target=fn.scrollToNextHighlightKeywordMark("0");if(!target){volantis.requestAnimationFrame(fn.scrollToFirstHighlightKeywordMark)}}
fn.scrollToNextHighlightKeywordMark=(id)=>{let input=id||(fn.markNextId+1)%fn.markNum;fn.markNextId=parseInt(input)let target=document.getElementById("keyword-mark-"+fn.markNextId);if(!target){fn.markNextId=(fn.markNextId+1)%fn.markNum;target=document.getElementById("keyword-mark-"+fn.markNextId);}
if(target){volantis.scroll.to(target,{addTop:-volantis.dom.header.offsetHeight-5,behavior:'instant'})}
return target}
fn.scrollToPrevHighlightKeywordMark=(id)=>{let input=id||(fn.markNextId-1+fn.markNum)%fn.markNum;fn.markNextId=parseInt(input)let target=document.getElementById("keyword-mark-"+fn.markNextId);if(!target){fn.markNextId=(fn.markNextId-1+fn.markNum)%fn.markNum;target=document.getElementById("keyword-mark-"+fn.markNextId);}
if(target){volantis.scroll.to(target,{addTop:-volantis.dom.header.offsetHeight-5,behavior:'instant'})}
return target}
fn.start=(keywords,querySelector)=>{fn.markNum=0
if(!keywords.length||!querySelector||(keywords.length==1&&keywords[0]=="null"))return;console.log(keywords);const walk=document.createTreeWalker(querySelector,NodeFilter.SHOW_TEXT,null);const allNodes=[];while(walk.nextNode()){if(!walk.currentNode.parentNode.matches('button, select, textarea'))allNodes.push(walk.currentNode);}
allNodes.forEach(node=>{const[indexOfNode]=fn.getIndexByWord(keywords,node.nodeValue);if(!indexOfNode.length)return;const slice=fn.mergeIntoSlice(0,node.nodeValue.length,indexOfNode);fn.highlightText(node,slice,'keyword');fn.highlightStyle()});}
fn.getIndexByWord=(words,text,caseSensitive=false)=>{const index=[];const included=new Set();words.forEach(word=>{const div=document.createElement('div');div.innerText=word;word=div.innerHTML;const wordLen=word.length;if(wordLen===0)return;let startPosition=0;let position=-1;if(!caseSensitive){text=text.toLowerCase();word=word.toLowerCase();}
while((position=text.indexOf(word,startPosition))>-1){index.push({position,word});included.add(word);startPosition=position+wordLen;}});index.sort((left,right)=>{if(left.position!==right.position){return left.position-right.position;}
return right.word.length-left.word.length;});return[index,included];};fn.mergeIntoSlice=(start,end,index)=>{let item=index[0];let{position,word}=item;const hits=[];const count=new Set();while(position+word.length<=end&&index.length!==0){count.add(word);hits.push({position,length:word.length});const wordEnd=position+word.length;index.shift();while(index.length!==0){item=index[0];position=item.position;word=item.word;if(wordEnd>position){index.shift();}else{break;}}}
return{hits,start,end,count:count.size};};fn.highlightText=(node,slice,className)=>{const val=node.nodeValue;let index=slice.start;const children=[];for(const{position,length}
of slice.hits){const text=document.createTextNode(val.substring(index,position));index=position+length;let mark=document.createElement('mark');mark.className=className;mark=fn.highlightStyle(mark)mark.appendChild(document.createTextNode(val.substr(position,length)));children.push(text,mark);}
node.nodeValue=val.substring(index,slice.end);children.forEach(element=>{node.parentNode.insertBefore(element,node);});}
fn.highlightStyle=(mark)=>{if(!mark)return;mark.id="keyword-mark-"+fn.markNum;fn.markNum++;mark.style.background="transparent";mark.style["border-bottom"]="1px dashed #ff2a2a";mark.style["color"]="#ff2a2a";mark.style["font-weight"]="bold";return mark}
fn.cleanHighlightStyle=()=>{document.querySelectorAll(".keyword").forEach(mark=>{mark.style.background="transparent";mark.style["border-bottom"]=null;mark.style["color"]=null;mark.style["font-weight"]=null;})}
return{start:(keywords,querySelector)=>{fn.start(keywords,querySelector)},startFromURL:()=>{fn.startFromURL()},scrollToNextHighlightKeywordMark:(id)=>{fn.scrollToNextHighlightKeywordMark(id)},scrollToPrevHighlightKeywordMark:(id)=>{fn.scrollToPrevHighlightKeywordMark(id)},cleanHighlightStyle:()=>{fn.cleanHighlightStyle()},}})()Object.freeze(highlightKeyWords);const DOMController={visible:(ele,type=true)=>{if(ele)ele.style.display=type===true?'block':'none';},remove:(param)=>{const node=document.querySelectorAll(param);node.forEach(ele=>{ele.remove();})},removeList:(list)=>{list.forEach(param=>{DOMController.remove(param)})},setAttribute:(param,attrName,attrValue)=>{const node=document.querySelectorAll(param);node.forEach(ele=>{ele.setAttribute(attrName,attrValue)})},setAttributeList:(list)=>{list.forEach(item=>{DOMController.setAttribute(item[0],item[1],item[2])})},setStyle:(param,styleName,styleValue)=>{const node=document.querySelectorAll(param);node.forEach(ele=>{ele.style[styleName]=styleValue;})},setStyleList:(list)=>{list.forEach(item=>{DOMController.setStyle(item[0],item[1],item[2])})},fadeIn:(e)=>{if(!e)return;e.style.visibility="visible";e.style.opacity=1;e.style.display="block";e.style.transition="all 0.5s linear";return e},fadeOut:(e)=>{if(!e)return;e.style.visibility="hidden";e.style.opacity=0;e.style.display="none";e.style.transition="all 0.5s linear";return e},fadeToggle:(e)=>{if(!e)return;if(e.style.visibility=="hidden"){e=DOMController.fadeIn(e)}else{e=DOMController.fadeOut(e)}
return e},fadeToggleList:(list)=>{list.forEach(param=>{DOMController.fadeToggle(param)})},hasClass:(e,c)=>{if(!e)return;return e.className.match(new RegExp('(\\s|^)'+c+'(\\s|$)'));},addClass:(e,c)=>{if(!e)return;e.classList.add(c);return e},removeClass:(e,c)=>{if(!e)return;e.classList.remove(c);return e},toggleClass:(e,c)=>{if(!e)return;if(DOMController.hasClass(e,c)){DOMController.removeClass(e,c)}else{DOMController.addClass(e,c)}
return e},toggleClassList:(list)=>{list.forEach(item=>{DOMController.toggleClass(item[0],item[1])})}}
Object.freeze(DOMController);const VolantisRequest={timeoutFetch:(url,ms,requestInit)=>{const controller=new AbortController()requestInit.signal?.addEventListener('abort',()=>controller.abort())let promise=fetch(url,{...requestInit,signal:controller.signal})if(ms>0){const timer=setTimeout(()=>controller.abort(),ms)promise.finally(()=>{clearTimeout(timer)})}
promise=promise.catch((err)=>{throw((err||{}).name==='AbortError')?new Error(`Fetch timeout:${url}`):err})return promise},Fetch:async(url,requestInit,timeout=15000)=>{const resp=await VolantisRequest.timeoutFetch(url,timeout,requestInit);if(!resp.ok)throw new Error(`Fetch error:${url}|${resp.status}`);let json=await resp.json()if(!json.success)throw json
return json},POST:async(url,data)=>{const requestInit={method:'POST',}
if(data){const formData=new FormData();Object.keys(data).forEach(key=>formData.append(key,String(data[key])))requestInit.body=formData;}
const json=await VolantisRequest.Fetch(url,requestInit)return json.data;},Get:async(url,data)=>{const json=await VolantisRequest.Fetch(url+(data?(`?${new URLSearchParams(data)}`):''),{method:'GET'})}}
Object.freeze(VolantisRequest);
